## Description
[main.py](https://training.bksec.vn/apiv2/files/local/qfWQxE0aFcaBq-JZfBmrZ?iat=1772124600&sig=zfXfxCZmgOIApmW1DOgCtE_YKvhdOu37hud4hz54uOs)\
[output.txt](https://training.bksec.vn/apiv2/files/local/yztpuCtIdGy8Cw-9I7_Qd?iat=1772124600&sig=P9ge9tyzkgUdnrOQlajmXn9Qwa4CaY2tWmlun2DW-Og)
## My solution
The first thing I noticed is: q is only 512-bit compare to 1024-bit p. We have C(x,y) from `output.txt`, since it lies on the Eliptic curve, we have the following:\
$y^2 \equiv x^3+p*x+q \pmod{n}$. Multiply both side by q and modify a little bit, we get: $0 \equiv (x^3-y^2).q +q^2 \pmod{n}$. As q is small enough with the bound of Coppersmith, we
use small_roots() to find q.
```
C = (331684832673225555657185530354059593041471116984840805306522594531978853167885107055149846202212469697139434025136609687185844933063810629178221461315545173721671612336430497607612729196270808386775998263978046456914906414510229706181165080827513164689603729319003326401161119329242774673300923395951337358068424605825460685634452814115194588282737178944025917105301947151206417070821314128088675711587376567755441409637547280054623308997494277453390728013031016, 829796072402589527909066445225870520590716850957137862239358251961668400199984699163435752987257909799615316214828684030994333065203182064470511651743712124345740720096419884742043948058982724486880146056421025157811489862162137975932182411872558583091106726104872589382006112673048102323965288244923358350975682048200306293854014669646600524587041296662862776603881683089126221361752609920774413257217782381234952923093688684735268947485420653567391809144455425)
n = 1068632192668282151058251465230958794115246305663032387217366973766422312942639619501438600335841599244702101705183796795180791345167681032979034124082210241804528127390596764463604753960964642309822410901274148488173237096953204574871785712056853970663577145569545798724548254063444742140590843747914511369390449899781933991859663992718085842044368474497153080964199724339318613324757368521295401801174048894460142078552883321854816846527437451716688881868344939
l=n.nbits()
x=C[0]
y=C[1]
A=y**2-x**3
P.<q>=PolynomialRing(Zmod(n))
f=q^2-A*q
roots = f.small_roots(X=2**(l//3+1), epsilon=0.03)
print(roots)
```
```
[0, 10794787806071027133356847106791345594375544799207749260804097309670405202605185728894433294673372212577971199557794558406347215185573708900884191407189649]
```
Knowing q, n can now be factored! Just like $\phi{n}$ in RSA problem, we have $N_E= \sharp E(F_P) \times \sharp E(F_q)$, and d can be found after finding $N_E$.
```
proof.arithmetic(False)
C = (331684832673225555657185530354059593041471116984840805306522594531978853167885107055149846202212469697139434025136609687185844933063810629178221461315545173721671612336430497607612729196270808386775998263978046456914906414510229706181165080827513164689603729319003326401161119329242774673300923395951337358068424605825460685634452814115194588282737178944025917105301947151206417070821314128088675711587376567755441409637547280054623308997494277453390728013031016, 829796072402589527909066445225870520590716850957137862239358251961668400199984699163435752987257909799615316214828684030994333065203182064470511651743712124345740720096419884742043948058982724486880146056421025157811489862162137975932182411872558583091106726104872589382006112673048102323965288244923358350975682048200306293854014669646600524587041296662862776603881683089126221361752609920774413257217782381234952923093688684735268947485420653567391809144455425)
n = 1068632192668282151058251465230958794115246305663032387217366973766422312942639619501438600335841599244702101705183796795180791345167681032979034124082210241804528127390596764463604753960964642309822410901274148488173237096953204574871785712056853970663577145569545798724548254063444742140590843747914511369390449899781933991859663992718085842044368474497153080964199724339318613324757368521295401801174048894460142078552883321854816846527437451716688881868344939
e=65537
q =10794787806071027133356847106791345594375544799207749260804097309670405202605185728894433294673372212577971199557794558406347215185573708900884191407189649
p = n//q
E = EllipticCurve(GF(p), [p, q])
ordp=E.order()
E=EllipticCurve(GF(q), [p, q])
ordq=E.order()
E=EllipticCurve(Zmod(n), [p, q])
C=E(C)
ordn=ordp*ordq
d = inverse_mod(e, ordn)
M = C*d
print(long_to_bytes(int(M[0])))

```
```
b'BKSEC{ce75644e6adb10831f8de972a59407ff79c9f361eabcef56963a6dc3e2f8e451}3q}i\xe7\xa2 \x0c\xd9\x003E\xc00\x0bZ\x0e!\xbd]\xa0\x8b\xb3~9>\xb3<\xe7b\x84\xb7\x02M\xf51\xdaGi\xda`E\xf3\x8bI}hOL\xfc\xf6\xeb6c\xc8/\x0f\xf2\xebF\xa7\xcd\x8e]\x96\xd7\xb3ezU7\x14\x8cO\x1aw\xd6\xba\xa8\xfc\xa4\xe6\x17\xfa~\xe0\xd4\x833\xedw\x06`\xf0W\xd5l\xbb\x05\x1d\x94_\xc4\x94\xb9\xb9&\xd1\xeeq\xe1\xd4\xdbQ1F\xf6\xe2\xf3\x1a\xac'
```

