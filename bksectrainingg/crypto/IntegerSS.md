## Description
[main.py](https://training.bksec.vn/apiv2/files/local/2-ec1rzh904GXKQDAdePd?iat=1771431600&sig=TMSLaj3-6A1XBWmHykkK4UTGJ-4Gp2qHhAbITXwNxgM)\
[output.txt](https://training.bksec.vn/apiv2/files/local/ioaJJc-2i_wlfcQ39WuLS?iat=1771431600&sig=Cc5Vk9DRxbduUWEBX3Y-nVUzkq2OyUE91IIdsLGhtlI)
## My solution
The problem gives only 5 points, too small compared to `deg=512`, so lagrange_polynomial do not work for this. However, we can solve this by using CRT:
* Let free coefficient be $c$, the shares be $(x_i,P(x_i))$
* We can get $c \equiv P(x_i) \pmod{x_i}$
* 5 16-bit integers are enough to recover a 64-bit integers by CRT
* Knowing c, let $P'(x) = \frac{(P(x) - c)}{x}$, work on 'new free coefficient'
* Keep doing until we recover all the coefficients of P(x)
```
shares = [(51804, 539221897197762259736755031302474700122016936209341675002647839889684612857714453128598415623541361860162687938338904926331898690389415361683603328971778161753493512207260433242391138314880172463064262670869072375088035286856200581814118416279666578327890185092987363085119326563172856088467869719126075194613741190610982292101186299514569730340515063418249080484598165562732567801866397009086879497424738146959525791539957622439680544278453248933620367515368370724836086572152240492742769737576553503938710954242343810431559277763380471403714188378392785402739213928723513208172286689166556647815417625963451659564099597923023922476198782182649002987665528687620994852998686291029938880561121396844502597499063170994034648239139622416924309322945127391423339527073047161566472096176299642476181951224640846579039662834359846135287968728541823338555660408051710815723306765449269711878769188621416613721367693466551334324777267923181512931123603027365478811849250753277945820089015529034794730225011240102539439601046273671115768903637512565792746968821719947295170357807352965461490577912226028475455258146756004912938649475938791792218031060096487518415336390883619122671883498994431056214182034927910326885212789331703685052807085977766574382893293969289589491868070964336078215757842865316601555951589414510461313058914254769340931855279134319548479228290941271587658028588841586248213014583048091003056632799952362549467142559328279514697698099465772471082467966014030125218877518284687795791309847918382267804917651547644658771145770612316562455916068606456387441522206853566523972904223432075404048730558003229613254756839931842006448645265510202622394885188353586607469881855641930145859400323995733750582380373874964850089676367342169931572866947016084677517664641785568758229919479669008683974852249449603029543049641729940755588385172804631198635858789758121540547263702410495769063637859621727242010702981918465496445552682049102519181693274499360544570076099606959282817653924720085289924540757562093575740363184980636003830611576006307366054561923258454748228173338915705142637712629309991001436042272379864536430823195694998041171342797299697661626650147580974955174436613076788880590060882265890887367515281321371664853541705553262927658240901052704986026033747455289777576895667417174311538005609019915180470039854515065540063899057921251385300923855214860193675746181995881164546883149224233603180021163915843642089), (34116, 711731034323293547164065460196109288431696796096928951891427109768853756111380164557815200134998767744441307047589771597798876717896767422621280234326262399916952009556716229805213927250313780173148747255670682736567155257507817091783390794040643108567581221738395695791689172534796459694641768761387719980029635701954296251847322517510257303740979965965366017318650121051021186091024205034772934420113302882237518257384022589406027122185373017464189726174053851038885483849591595592974838106894290829865129368329027216018870057337687078193363473113582193701633154780994167946980533448534742147158608656699056091830662661200849479404995529852265081015378700117205780824926335708646589520196858913955118646958346315818918148286688329234752865638302551724901210742791457580161205468012540203084653129789582984535456501870499760670608318363501307366104432916373875873140563429226119334165701391184776040253242531322398120065715100741720732117809956987333195746940189528368809653064121074544551210279999865664875816239964688472398274828481369967603397145203104840944018144453994760611069559824050655981404941615196634342182167440239118501079912941048066020866066897240715256247858272777780646979441114030281188313025730388845959857334468350885461379336658649959859345351554828624129798965280536225287543046495604393945962574349471476497859168784289214281549418238331048689570466887299475932071252842280147086866097335996109999558673915937574746132559105160981714561400215821253181955750262301965946666214503641001071046473754586593773559366046440315168669891198575773448371419353853580337243249928863387288937691264443393694802870531061510006862571360081812007218790376933630167651255423143854703236866259979566992495420057670388381676238851764926526205058967618513590398108181552237831526137135295421172908457277016331358216150225429725253376899787109544876753636624193750690384453906488543818551001488219772299675207803171221457523696072980829016365020290038639470597313443634755726517125577462671223675607107164601791123108543511106832163857179712873473995640111537456646549898602132036850022527084981980461356456271669841677251153658488051768586568165605043792706947189005677183694285197186762632442997426204928371238981117473566286947089339996091503634511321499014399054858236249060505044594570768210785345941413764556012104754918776132537), (47804, 730215716299622310043189304612900310234620578264039567167829360220714698112107919347769449048312848976517779015918964409890451033017370822912551666161333929589040164997670338609932150322274812646256812709982530205015030106135427877988020899120846333272710610417642214222195074330639118735708108752384338226542984490540227585043426625276450578042806664491710094608558399126708352382168272002040166543797036828451297107923629768766080377574981380220891592825007914365715352775091166199799289863844401188830520492754109548423939344908663588890758296449504397959414463892441222974821550150300074010148844229210503986844903742952256346877505726604861148280291328844206954637660199131520791677307537727826501828459256514735665603251407752026557107104920476398109623555799943285975926973281191198860849647138169292853608688215208920675517640043199828856364818526901218610989107540542913318626483631851481753292746719730728702256366051824225565902049984407139358840273591387764622955048136116321271112930896780996889490999882367187829990280047221249226392885127658951676854154790541756734452122526687819610607824791489274622075702958583221867222187592202344838842688638020986552435744403203883698382490692269529116465778932600099627023859138304234227710674837970183238144209433749476264247944680794401799083713042744943440001589849068410888927136762325644960074229336152393786969165114434838522155177245717540489133959371328725762357268953956927879838694662692688084075305796409899010486442629023904641374747975930891745167528704539339994015671219269647575827562637292690860251084848970608694503307654660504184663823425829727625348242252419303801811395867132093173743817527111691976293044446226396497083856338436788928943768619187027833879942842885891505106767845282230584472380922472148193972330172657015940024419871267146655938032333959409512928724161921594152988012661533812240245976909071078376004336086476419280078074925106711703751605235178311395092397337049680364666957437088914641207751382034431225023536349717646313507542467351869311541633773920462910821783180665248048877869748362567335259544624574579075109543575769117995335418504891353202157167418768237427815339435766032382878321694132361426948839081655813952592770924430056082995713867001845507963933107816766347125802196754949103475461702102033460058528455975494599413771185951953913912603668575683665852407732998091196666706740582232088619929591237938578089), (979, 181557117519616628053024842363244655894217941325222653227921632893068240228310006430210427961003976876653857112817371206880343169782753395720601456390710466680519173363942411480085121299714564269506208204136644015114046805619512582447315648111130960824292249781203277976650927136619530322153568881272121366399062957238489575350826542547883559600066555888622544489004462594925194904733431577598451474574187157024770319686397887558725639754118117719402803088872039615549902243785802874373460804290373483267665592138744203760637441377951772620880362951638495027940328333933507738830263098674255476355189509269509046398798913889380550934940822488121790192602685355845586771451481797259876967376600632484266961972869329784711990420009977501385302421911264044648029568207756567538968393620187872084680924457832843492909119265605936219634841448257466044978878058302175406785499418199897067149554525112974987915934827720895741648968858559860913333959166581551763645555755020599367840231686340430408929721801238775681993582156121465156936745245126466071730835742551541537661349374498675215756578435533306401267649748086523925110719252897544813663656231822322780636105285387140637203351614866476977393646270070499678687128331037009083231079360589817922436987318331660773934513115243416442193517107502375794515022337352259169542510432327459195799024071147049003571026143837187017511772888552460260542694067414710907966941894702446610977295867057423045323774918971653418237606880470246528186746088173087886284846786582906620967413503150064992945244494258110407639), (22826, 3117722248897273259643451336313950967978874030077452262178719442930338929279613899714207078128243653982928871847186234229020591304352342684758909337705847843232993165074244251628158966374461512673175147488151867264235244474348210495177955138309240545819907717079127212226943927747541103305714169108044256564612675400291885087480059738550425835824818758230473946108193717391448653526742537026023398233852605622416327387876154508926543630510336192321324520450900609199863229371185197341652290175451243031449470332641983776766514326301818010107692504981237452453677132870275635938664735672290835867910945780666512332832656128074641373674748851702770986631722664504007561954223514027260898619146926624151278386995221955549429559729878211127637479065938845325056010761234354335934725270144566288622459586263888984487386750784032948076113547770257689102117815880361640950991031933130674119839377591418575679508342635361066820108620960531441065376250822247680673597757769434691254597669159702192572123184576047653860832179677564516770873756403181538870342900284822325265837063420911122819624795282406201928400187084668388774995021357971058218185206237091381615676454674497803909971083453521566889339803308417772572795199948314193941861523784254680974556767029972909125085153374500633878185538988598640107257684047774459911229101621190087830021839437543291001471226859120364431922443065716462801864667647442085897850234363372809697878274626421687554451347452021996789525196363334716722250594341337972224292849888630210340258326918151808891080194483670864291640980479364415859750118333321540322684123437678979046340936922415738624608353136128719847322686007758481888446285822538027594431772240899591807145831619136329617704596282757230127276294542295407264366286570070793395550160643590786738997892290765749446200997979113687025551875188220696345504491823865196971146093731797033939888948057760949441091895869849504550310561871960541374774765312941337589533160376727574549636838979298555332678465734008134933385449996894127929790019682341996352228277097894696287826197029121423865515144755866919521832786311340208223843782814608507197173971783653451539161093592359683295850421597379286418795802768740435112628829615215869158960319960944360654271030060727416977)]
ct = "a0c16595aaf0af6cd20af4d6f9f75d633ee47abae57c860e63df8767bc186afd413eb30572f7a8e94aff30304428ef9e3e60ea9f65d8afcaba1538318575994c0ca59a6876e9735e370dfb9796906b9a"
deg=512
cs=[]
ms=[]
poly=[]
val=[c[1] for c in shares]
def eval(poly, x):
    return sum([a * x**i for i, a in enumerate(poly)])
for i in range(5):
    ms.append(shares[i][0])
for i in range(5):
    for j in range(i+1,5):
        kk=gcd(ms[i],ms[j])
        ms[j]//=kk
for _ in range(deg+1):
    cs=[]
    for i in range(5):
        cs.append(val[i]%ms[i])
    kk=crt(cs,ms)
    poly.append(kk)
    for i in range(5):
        val[i]-=kk
        val[i]//=shares[i][0]
secret = eval(poly,0x31104)
key = sha256(str(secret).encode()).digest()[:16]
cipher = AES.new(key, AES.MODE_ECB)

m = cipher.decrypt(bytes.fromhex(ct))
print(m)
```
```
b'BKSEC{43cd8daedda45e539a0694c37dc88186458fc3bcc9558bf9c2b5e97678acbe0a}\t\t\t\t\t\t\t\t\t'
```
