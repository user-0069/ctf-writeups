## Description
[chall.py](https://training.bksec.vn/apiv2/files/local/GUYsMkSeN3gGBZpk9eplE?iat=1770608400&sig=LVb_zW8egdFYTilZSawcqteNRQ3qx1XIa2N8WG2ZsX0)\
[output.txt](https://training.bksec.vn/apiv2/files/local/JS1vdP820nbEfMavhU0Ug?iat=1770608400&sig=1U5OBqZgT4Sgb3pe9DhyaZxeHHgFBm5yH7k8XPFD41I)
## My solution
According to the source code, $p^{q^{a} mod(\phi(n)) } +q^{p^{b} mod(\phi(n))} \equiv s \quad mod(n)$.  
* $p^{q^{a} mod(\phi(n))} \equiv p^{q^{a} mod(\phi(q)) } \equiv p^{q^{a} mod(q-1) } \equiv p^1 \equiv p \quad mod(q) $
* $p^{q^{a} mod(\phi(n))} \equiv 0 \quad mod(p)$\
$\Longrightarrow p^{q^{a} mod(\phi(n))} \equiv p \quad mod(n)$

By that we can prove $s = p + q \quad mod(n)=p+q$ ( as $p+q<n$). Finding p and q is trivial since we know $p.q$ and $p+q$.
```
s=16187655423473274971014370822798349531015223153134191064809433751402760870188576231511739990895969339122469104693235668498359252182115681483258339107002714
c=23732987849536462635872946613737766778217778441095050603162485419094873555963453411781262026638051131273719437334873736152761435425938252415096151250447732175023526049499590211978924822930871484174446952014209722199010972800356041979010500375129218565890114148329915473617339037178477080024312471127930899266
n=65510046843986766728769468942483953908384862362702315077661524681037936860106629864754586655429321999002248043253891579154215976299402264232355993548538561032947850750030496237651524442593210677953045981424554643594556022492602206684822716822684775120533169302357201262561031248379614047163751890565716650693
d=s*s-4*n
d=iroot(d,2)[0]
p=(s+d)//2
q=(s-d)//2
phi=(p-1)*(q-1)
e=65537
d=inverse(e,phi)
m=pow(c,d,n)
print(long_to_bytes(m))
```
```
b'BKSEC{48592b41c027316449e0bf0496db25606718b1ea18ec91109c2ddf60afcc80fe}'
```
